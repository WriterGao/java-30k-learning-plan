# Day11 学习笔记

> **学习目标**：今天的笔记目标是"**能复述、能画图、能用代码验证**"，不要抄书。  
> **参考课件**：`00-教学课件_设计模式之创建型模式详解.md`

---

## 1. 设计模式概述

### 1.1 什么是设计模式

请用自己的话描述设计模式：

- **定义**：
- **核心价值**：
- **三要素**：

### 1.2 GOF 23 种设计模式分类

请画出分类图（或用文字列出）：

- **创建型**（5 种）：
- **结构型**（7 种）：
- **行为型**（11 种）：

### 1.3 七大设计原则

请用自己的话总结每个原则：

| 原则 | 我的理解 | 一个实际例子 |
|------|---------|-------------|
| **单一职责（SRP）** | | |
| **开闭原则（OCP）** | | |
| **里氏替换（LSP）** | | |
| **依赖倒置（DIP）** | | |
| **接口隔离（ISP）** | | |
| **迪米特法则（LoD）** | | |
| **合成复用（CRP）** | | |

**哪个原则你觉得最重要？为什么？**

---

## 2. 单例模式

### 2.1 六种实现方式

请对每种方式写出核心代码和理解：

#### 饿汉式（静态常量）

```java
// 在此写出核心代码
```

- **线程安全的原因**：
- **缺点**：

#### 饿汉式（静态代码块）

```java
// 在此写出核心代码
```

- **与静态常量方式的区别**：

#### 懒汉式（线程不安全）

```java
// 在此写出核心代码
```

- **为什么线程不安全**（画出时序图）：

#### 懒汉式（synchronized）

```java
// 在此写出核心代码
```

- **为什么性能差**：

#### DCL 双重检查锁

```java
// 在此写出核心代码
```

- **为什么需要两次检查**：
- **为什么需要 volatile**（⭐重点，请详细描述指令重排序问题）：

#### 静态内部类

```java
// 在此写出核心代码
```

- **懒加载的原因**：
- **线程安全的原因**：

#### 枚举方式

```java
// 在此写出核心代码
```

- **为什么是最推荐的**：
- **为什么能防反射**：
- **为什么能防序列化破坏**：

### 2.2 对比总结

请自己画一个对比表：

| 实现方式 | 线程安全 | 懒加载 | 防反射 | 防序列化 | 推荐度 |
|---------|---------|--------|--------|---------|--------|
| | | | | | |
| | | | | | |

### 2.3 反射破坏单例

- **如何通过反射破坏**：
- **防御方案**：

### 2.4 序列化破坏单例

- **如何通过序列化破坏**：
- **readResolve() 是什么原理**：

### 2.5 Spring 中的单例

- **Spring 单例与 GOF 单例的区别**：
- **Spring 单例的实现原理**（ConcurrentHashMap + DCL）：

---

## 3. 工厂模式

### 3.1 简单工厂

- **核心思想**：
- **实现方式**：
- **优点**：
- **缺点**：
- **违反了什么原则**：

### 3.2 工厂方法

- **核心思想**：
- **与简单工厂的区别**：
- **如何遵循开闭原则**：
- **缺点**：

### 3.3 抽象工厂

- **什么是产品族**：
- **什么是产品等级结构**：
- **核心思想**：
- **适用场景**：
- **优缺点**：

### 3.4 三种工厂对比

请自己填写对比表：

| 维度 | 简单工厂 | 工厂方法 | 抽象工厂 |
|------|---------|---------|---------|
| 工厂数量 | | | |
| 产品数量 | | | |
| 扩展方式 | | | |
| 开闭原则 | | | |
| 适用场景 | | | |

### 3.5 Spring 中的工厂

- **BeanFactory 是什么**：
- **FactoryBean 是什么**：
- **BeanFactory vs FactoryBean**：

---

## 4. 建造者模式

### 4.1 经典建造者（Director + Builder）

- **四个角色**：
- **适用场景**：

### 4.2 链式建造者

```java
// 在此写出链式建造者的核心代码骨架
```

- **核心技巧**：setter 返回 this
- **与 Lombok @Builder 的关系**：

### 4.3 建造者 vs 工厂

请用自己的话描述两者的区别：

- **工厂模式关注**：
- **建造者模式关注**：
- **举例说明**：

### 4.4 实际应用

列举你知道的使用建造者模式的 JDK/框架类：

1. 
2. 
3. 

---

## 5. 原型模式

### 5.1 Cloneable 与 clone()

- **Cloneable 接口的作用**：
- **为什么 clone() 在 Object 类中而不是 Cloneable 中**：

### 5.2 浅拷贝 vs 深拷贝

请画图说明浅拷贝和深拷贝的区别：

```
（在此画图）
```

- **浅拷贝的问题**：
- **深拷贝的实现方式**：
  1. 重写 clone()：
  2. 序列化：
  3. JSON：

### 5.3 Spring 中的原型

- **@Scope("prototype") 的含义**：
- **Spring prototype 与 GOF 原型模式的区别**：

---

## 6. 创建型模式总结

### 6.1 四种创建型模式的关系

请用自己的话描述它们各自解决什么问题：

- **单例模式**：解决
- **工厂模式**：解决
- **建造者模式**：解决
- **原型模式**：解决

### 6.2 Spring/JDK 中的应用

请列举至少 5 个在 Spring 或 JDK 中的创建型模式应用：

1. 
2. 
3. 
4. 
5. 

---

## 7. 今日自我检测

请尝试回答以下问题（不看资料）：

- [ ] 能否默写出 DCL 双重检查锁的完整代码？
- [ ] 能否解释 volatile 在 DCL 中的作用（指令重排序）？
- [ ] 能否画出三种工厂模式的类图？
- [ ] 能否说清楚建造者模式和工厂模式的区别？
- [ ] 能否说清楚浅拷贝和深拷贝的区别？
- [ ] 能否说出枚举单例防反射、防序列化的原理？

---

## 8. 疑问与收获

### 今日疑问



### 今日最大收获



### 明日计划

