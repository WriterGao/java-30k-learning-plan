# è®¾è®¡æ¨¡å¼ä¹‹ç»“æ„å‹æ¨¡å¼è¯¦è§£

> **å­¦ä¹ ç›®æ ‡**ï¼šæ·±å…¥ç†è§£ GOF 23 ç§è®¾è®¡æ¨¡å¼ä¸­çš„ 7 ç§ç»“æ„å‹æ¨¡å¼ï¼ˆé€‚é…å™¨ã€è£…é¥°å™¨ã€ä»£ç†ã€å¤–è§‚ã€æ¡¥æ¥ã€ç»„åˆã€äº«å…ƒï¼‰ï¼ŒæŒæ¡ç»“æ„å‹æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³ï¼Œèƒ½åœ¨å®é™…é¡¹ç›®å’Œé¢è¯•ä¸­çµæ´»è¿ç”¨ã€‚

---

## ç›®å½•

- [ä¸€ã€ç»“æ„å‹æ¨¡å¼æ¦‚è¿°](#ä¸€ç»“æ„å‹æ¨¡å¼æ¦‚è¿°)
  - [1.1 ä»€ä¹ˆæ˜¯ç»“æ„å‹æ¨¡å¼](#11-ä»€ä¹ˆæ˜¯ç»“æ„å‹æ¨¡å¼)
  - [1.2 ç»“æ„å‹æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³](#12-ç»“æ„å‹æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³)
  - [1.3 ä¸ƒç§ç»“æ„å‹æ¨¡å¼æ¦‚è§ˆ](#13-ä¸ƒç§ç»“æ„å‹æ¨¡å¼æ¦‚è§ˆ)
- [äºŒã€é€‚é…å™¨æ¨¡å¼ï¼ˆAdapterï¼‰](#äºŒé€‚é…å™¨æ¨¡å¼adapter)
- [ä¸‰ã€è£…é¥°å™¨æ¨¡å¼ï¼ˆDecoratorï¼‰](#ä¸‰è£…é¥°å™¨æ¨¡å¼decorator)
- [å››ã€ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰](#å››ä»£ç†æ¨¡å¼proxy)
- [äº”ã€å¤–è§‚æ¨¡å¼ï¼ˆFacadeï¼‰](#äº”å¤–è§‚æ¨¡å¼facade)
- [å…­ã€æ¡¥æ¥æ¨¡å¼ï¼ˆBridgeï¼‰](#å…­æ¡¥æ¥æ¨¡å¼bridge)
- [ä¸ƒã€ç»„åˆæ¨¡å¼ï¼ˆCompositeï¼‰](#ä¸ƒç»„åˆæ¨¡å¼composite)
- [å…«ã€äº«å…ƒæ¨¡å¼ï¼ˆFlyweightï¼‰](#å…«äº«å…ƒæ¨¡å¼flyweight)
- [ä¹ã€ç»“æ„å‹æ¨¡å¼åœ¨ Spring/JDK ä¸­çš„åº”ç”¨æ€»ç»“](#ä¹ç»“æ„å‹æ¨¡å¼åœ¨-springjdk-ä¸­çš„åº”ç”¨æ€»ç»“)
- [åã€é¢è¯•é«˜é¢‘é—®é¢˜](#åé¢è¯•é«˜é¢‘é—®é¢˜)

---

# ä¸€ã€ç»“æ„å‹æ¨¡å¼æ¦‚è¿°

## 1.1 ä»€ä¹ˆæ˜¯ç»“æ„å‹æ¨¡å¼

**ç»“æ„å‹æ¨¡å¼ï¼ˆStructural Patternï¼‰** å…³æ³¨å¦‚ä½•**å°†ç±»æˆ–å¯¹è±¡ç»„åˆæˆæ›´å¤§çš„ç»“æ„**ï¼Œä»¥ä¿æŒç»“æ„çš„çµæ´»å’Œé«˜æ•ˆã€‚å®ƒæè¿°äº†å¦‚ä½•ç»„åˆç±»å’Œå¯¹è±¡ä»¥è·å¾—æ–°åŠŸèƒ½ã€‚

### ç»“æ„å‹æ¨¡å¼çš„æ ¸å¿ƒä»·å€¼

1. **ç»„åˆä¼˜äºç»§æ‰¿**ï¼šé€šè¿‡ç»„åˆå¯¹è±¡æ¥æ‰©å±•åŠŸèƒ½ï¼Œè€Œä¸æ˜¯é€šè¿‡ç»§æ‰¿
2. **è§£è€¦**ï¼šå°†æ¥å£ä¸å®ç°åˆ†ç¦»ï¼Œé™ä½ç³»ç»Ÿè€¦åˆåº¦
3. **çµæ´»æ€§**ï¼šå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ”¹å˜å¯¹è±¡çš„ç»“æ„å’Œè¡Œä¸º
4. **å¤ç”¨æ€§**ï¼šé€šè¿‡ç»„åˆå·²æœ‰å¯¹è±¡ï¼Œå®ç°åŠŸèƒ½çš„å¤ç”¨

---

## 1.2 ç»“æ„å‹æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³

**æ ¸å¿ƒæ€æƒ³**ï¼š**"é€šè¿‡ç»„åˆè·å¾—æ›´å¤§çš„ç»“æ„"**

ä¸åˆ›å»ºå‹æ¨¡å¼å…³æ³¨"å¦‚ä½•åˆ›å»ºå¯¹è±¡"ä¸åŒï¼Œç»“æ„å‹æ¨¡å¼å…³æ³¨"å¦‚ä½•ç»„åˆå¯¹è±¡"ã€‚

### ä¸¤ç§å®ç°æ–¹å¼

| æ–¹å¼ | è¯´æ˜ | ç¤ºä¾‹æ¨¡å¼ |
|------|------|----------|
| **ç±»ç»“æ„å‹æ¨¡å¼** | ä½¿ç”¨ç»§æ‰¿æœºåˆ¶æ¥ç»„åˆæ¥å£æˆ–å®ç° | é€‚é…å™¨æ¨¡å¼ï¼ˆç±»é€‚é…å™¨ï¼‰ |
| **å¯¹è±¡ç»“æ„å‹æ¨¡å¼** | ä½¿ç”¨ç»„åˆæˆ–èšåˆæ¥ç»„åˆå¯¹è±¡ | é€‚é…å™¨æ¨¡å¼ï¼ˆå¯¹è±¡é€‚é…å™¨ï¼‰ã€è£…é¥°å™¨ã€ä»£ç†ã€å¤–è§‚ã€æ¡¥æ¥ã€ç»„åˆã€äº«å…ƒ |

> **æ³¨æ„**ï¼šå¤§å¤šæ•°ç»“æ„å‹æ¨¡å¼éƒ½æ˜¯**å¯¹è±¡ç»“æ„å‹æ¨¡å¼**ï¼Œå› ä¸ºç»„åˆæ¯”ç»§æ‰¿æ›´çµæ´»ã€‚

---

## 1.3 ä¸ƒç§ç»“æ„å‹æ¨¡å¼æ¦‚è§ˆ

```mermaid
graph TB
    A[ç»“æ„å‹æ¨¡å¼<br/>Structural Patterns] --> B[é€‚é…å™¨ Adapter]
    A --> C[è£…é¥°å™¨ Decorator]
    A --> D[ä»£ç† Proxy]
    A --> E[å¤–è§‚ Facade]
    A --> F[æ¡¥æ¥ Bridge]
    A --> G[ç»„åˆ Composite]
    A --> H[äº«å…ƒ Flyweight]
    
    B --> B1[ç±»é€‚é…å™¨<br/>å¯¹è±¡é€‚é…å™¨]
    C --> C1[åŠ¨æ€å¢å¼ºåŠŸèƒ½]
    D --> D1[é™æ€ä»£ç†<br/>JDKåŠ¨æ€ä»£ç†<br/>CGLIBä»£ç†]
    E --> E1[ç®€åŒ–å¤æ‚å­ç³»ç»Ÿ]
    F --> F1[æŠ½è±¡ä¸å®ç°åˆ†ç¦»]
    G --> G1[æ ‘å½¢ç»“æ„]
    H --> H1[å…±äº«ç»†ç²’åº¦å¯¹è±¡]
    
    style A fill:#f3e5f5
    style B fill:#e1f5fe
    style C fill:#e1f5fe
    style D fill:#e1f5fe
    style E fill:#e1f5fe
    style F fill:#e1f5fe
    style G fill:#fff3e0
    style H fill:#fff3e0
```

### ä¸ƒç§æ¨¡å¼å¯¹æ¯”

| æ¨¡å¼ | æ ¸å¿ƒç›®çš„ | é€‚ç”¨åœºæ™¯ | é‡ç‚¹æŒæ¡ |
|------|---------|----------|----------|
| **é€‚é…å™¨** | è®©ä¸å…¼å®¹çš„æ¥å£èƒ½å¤ŸååŒå·¥ä½œ | éœ€è¦ä½¿ç”¨ç°æœ‰ç±»ï¼Œä½†å…¶æ¥å£ä¸ç¬¦åˆéœ€æ±‚ | â­â­â­â­â­ |
| **è£…é¥°å™¨** | åŠ¨æ€åœ°ç»™å¯¹è±¡æ·»åŠ é¢å¤–çš„èŒè´£ | éœ€è¦åœ¨ä¸ä¿®æ”¹åŸç±»çš„æƒ…å†µä¸‹æ‰©å±•åŠŸèƒ½ | â­â­â­â­â­ |
| **ä»£ç†** | ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—® | éœ€è¦æ§åˆ¶å¯¹è±¡è®¿é—®ã€å»¶è¿ŸåŠ è½½ã€AOP | â­â­â­â­â­ |
| **å¤–è§‚** | ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ | ç®€åŒ–å¤æ‚å­ç³»ç»Ÿçš„ä½¿ç”¨ | â­â­â­â­ |
| **æ¡¥æ¥** | å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ– | éœ€è¦åœ¨å¤šä¸ªç»´åº¦ä¸Šç‹¬ç«‹æ‰©å±• | â­â­â­â­ |
| **ç»„åˆ** | å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤º"éƒ¨åˆ†-æ•´ä½“"çš„å±‚æ¬¡ç»“æ„ | éœ€è¦è¡¨ç¤ºæ ‘å½¢ç»“æ„ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿï¼‰ | â­â­â­ |
| **äº«å…ƒ** | è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ | éœ€è¦åˆ›å»ºå¤§é‡ç›¸ä¼¼å¯¹è±¡ï¼ˆå¦‚å­—ç¬¦ã€æ£‹å­ï¼‰ | â­â­â­ |

> **å­¦ä¹ é‡ç‚¹**ï¼šé€‚é…å™¨ã€è£…é¥°å™¨ã€ä»£ç†æ˜¯**é¢è¯•é«˜é¢‘**ï¼Œå¿…é¡»æ·±å…¥æŒæ¡ã€‚å¤–è§‚å’Œæ¡¥æ¥ä¹Ÿè¦ç†è§£ã€‚ç»„åˆå’Œäº«å…ƒäº†è§£å³å¯ã€‚

---

# äºŒã€é€‚é…å™¨æ¨¡å¼ï¼ˆAdapterï¼‰

## 2.1 ä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼

**é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰** å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚

### ç”Ÿæ´»ä¸­çš„ä¾‹å­

- **ç”µæºé€‚é…å™¨**ï¼š220V äº¤æµç”µ â†’ 5V ç›´æµç”µï¼ˆæ‰‹æœºå……ç”µå™¨ï¼‰
- **è½¬æ¥å¤´**ï¼šUSB-A â†’ USB-C
- **ç¿»è¯‘å™¨**ï¼šå°†ä¸€ç§è¯­è¨€ç¿»è¯‘æˆå¦ä¸€ç§è¯­è¨€

### é€‚é…å™¨æ¨¡å¼çš„ç»“æ„

```mermaid
classDiagram
    class Target {
        <<interface>>
        +request()
    }
    class Adaptee {
        +specificRequest()
    }
    class Adapter {
        -adaptee: Adaptee
        +request()
    }
    class Client {
        +main()
    }
    
    Client --> Target
    Adapter ..|> Target
    Adapter --> Adaptee
```

**è§’è‰²è¯´æ˜**ï¼š

| è§’è‰² | è¯´æ˜ |
|------|------|
| **Targetï¼ˆç›®æ ‡æ¥å£ï¼‰** | å®¢æˆ·æœŸæœ›çš„æ¥å£ |
| **Adapteeï¼ˆé€‚é…è€…ï¼‰** | éœ€è¦è¢«é€‚é…çš„ç±»ï¼ˆç°æœ‰ç±»ï¼Œæ¥å£ä¸å…¼å®¹ï¼‰ |
| **Adapterï¼ˆé€‚é…å™¨ï¼‰** | å°† Adaptee çš„æ¥å£è½¬æ¢æˆ Target æ¥å£ |
| **Clientï¼ˆå®¢æˆ·ç«¯ï¼‰** | ä½¿ç”¨ Target æ¥å£çš„ç±» |

---

## 2.2 é€‚é…å™¨æ¨¡å¼çš„ä¸¤ç§å®ç°æ–¹å¼

### 2.2.1 ç±»é€‚é…å™¨æ¨¡å¼ï¼ˆä½¿ç”¨ç»§æ‰¿ï¼‰

**æ ¸å¿ƒ**ï¼šAdapter ç»§æ‰¿ Adapteeï¼ŒåŒæ—¶å®ç° Target æ¥å£ã€‚

```java
// ç›®æ ‡æ¥å£
interface Target {
    void request();
}

// é€‚é…è€…ï¼ˆç°æœ‰ç±»ï¼Œæ¥å£ä¸å…¼å®¹ï¼‰
class Adaptee {
    public void specificRequest() {
        System.out.println("é€‚é…è€…çš„æ–¹æ³•è¢«è°ƒç”¨");
    }
}

// ç±»é€‚é…å™¨ï¼ˆç»§æ‰¿ Adapteeï¼Œå®ç° Targetï¼‰
class ClassAdapter extends Adaptee implements Target {
    @Override
    public void request() {
        // è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•
        specificRequest();
    }
}

// å®¢æˆ·ç«¯
public class Client {
    public static void main(String[] args) {
        Target target = new ClassAdapter();
        target.request(); // è¾“å‡ºï¼šé€‚é…è€…çš„æ–¹æ³•è¢«è°ƒç”¨
    }
}
```

**ä¼˜ç‚¹**ï¼š
- ä»£ç ç®€å•ï¼Œç›´æ¥ç»§æ‰¿å³å¯

**ç¼ºç‚¹**ï¼š
- éœ€è¦ç»§æ‰¿ Adapteeï¼Œå¦‚æœ Adaptee æ˜¯ç±»è€Œä¸æ˜¯æ¥å£ï¼Œåˆ™æ— æ³•ä½¿ç”¨
- è¿åäº†ç»„åˆä¼˜äºç»§æ‰¿çš„åŸåˆ™

---

### 2.2.2 å¯¹è±¡é€‚é…å™¨æ¨¡å¼ï¼ˆä½¿ç”¨ç»„åˆï¼‰â­ **æ¨è**

**æ ¸å¿ƒ**ï¼šAdapter æŒæœ‰ Adaptee çš„å¼•ç”¨ï¼Œå®ç° Target æ¥å£ã€‚

```java
// ç›®æ ‡æ¥å£
interface Target {
    void request();
}

// é€‚é…è€…
class Adaptee {
    public void specificRequest() {
        System.out.println("é€‚é…è€…çš„æ–¹æ³•è¢«è°ƒç”¨");
    }
}

// å¯¹è±¡é€‚é…å™¨ï¼ˆæŒæœ‰ Adaptee å¼•ç”¨ï¼Œå®ç° Targetï¼‰
class ObjectAdapter implements Target {
    private Adaptee adaptee;
    
    public ObjectAdapter(Adaptee adaptee) {
        this.adaptee = adaptee;
    }
    
    @Override
    public void request() {
        adaptee.specificRequest();
    }
}

// å®¢æˆ·ç«¯
public class Client {
    public static void main(String[] args) {
        Adaptee adaptee = new Adaptee();
        Target target = new ObjectAdapter(adaptee);
        target.request(); // è¾“å‡ºï¼šé€‚é…è€…çš„æ–¹æ³•è¢«è°ƒç”¨
    }
}
```

**ä¼˜ç‚¹**ï¼š
- âœ… æ›´çµæ´»ï¼Œå¯ä»¥é€‚é… Adaptee åŠå…¶å­ç±»
- âœ… ç¬¦åˆç»„åˆä¼˜äºç»§æ‰¿çš„åŸåˆ™
- âœ… å¯ä»¥é€‚é…å¤šä¸ª Adaptee

**ç¼ºç‚¹**ï¼š
- éœ€è¦é¢å¤–åˆ›å»ºä¸€ä¸ª Adaptee å¯¹è±¡

> **æ¨èä½¿ç”¨å¯¹è±¡é€‚é…å™¨æ¨¡å¼**ï¼Œå› ä¸ºå®ƒæ›´çµæ´»ï¼Œç¬¦åˆè®¾è®¡åŸåˆ™ã€‚

---

## 2.3 å®é™…åº”ç”¨åœºæ™¯

### åœºæ™¯1ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“

```java
// ç¬¬ä¸‰æ–¹åº“çš„æ¥å£ï¼ˆä¸å…¼å®¹ï¼‰
class ThirdPartyLogger {
    public void log(String message) {
        System.out.println("[ThirdParty] " + message);
    }
}

// æˆ‘ä»¬ç³»ç»Ÿçš„æ—¥å¿—æ¥å£
interface Logger {
    void info(String message);
    void error(String message);
}

// é€‚é…å™¨
class LoggerAdapter implements Logger {
    private ThirdPartyLogger thirdPartyLogger;
    
    public LoggerAdapter(ThirdPartyLogger logger) {
        this.thirdPartyLogger = logger;
    }
    
    @Override
    public void info(String message) {
        thirdPartyLogger.log("[INFO] " + message);
    }
    
    @Override
    public void error(String message) {
        thirdPartyLogger.log("[ERROR] " + message);
    }
}
```

### åœºæ™¯2ï¼šJDK ä¸­çš„é€‚é…å™¨æ¨¡å¼

**InputStreamReader** æ˜¯é€‚é…å™¨æ¨¡å¼çš„å…¸å‹åº”ç”¨ï¼š

```java
// InputStreamReader å°†å­—èŠ‚æµï¼ˆInputStreamï¼‰é€‚é…æˆå­—ç¬¦æµï¼ˆReaderï¼‰
Reader reader = new InputStreamReader(new FileInputStream("file.txt"));
```

---

## 2.4 é€‚é…å™¨æ¨¡å¼ vs è£…é¥°å™¨æ¨¡å¼ vs ä»£ç†æ¨¡å¼

| æ¨¡å¼ | ç›®çš„ | å…³æ³¨ç‚¹ |
|------|------|--------|
| **é€‚é…å™¨** | è½¬æ¢æ¥å£ï¼Œè®©ä¸å…¼å®¹çš„æ¥å£ååŒå·¥ä½œ | æ¥å£è½¬æ¢ |
| **è£…é¥°å™¨** | åŠ¨æ€å¢å¼ºåŠŸèƒ½ï¼Œä¸æ”¹å˜æ¥å£ | åŠŸèƒ½å¢å¼º |
| **ä»£ç†** | æ§åˆ¶è®¿é—®ï¼Œä¸æ”¹å˜æ¥å£ | è®¿é—®æ§åˆ¶ |

---

# ä¸‰ã€è£…é¥°å™¨æ¨¡å¼ï¼ˆDecoratorï¼‰

## 3.1 ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼

**è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰** åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°å™¨æ¨¡å¼æ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´»ã€‚

### ç”Ÿæ´»ä¸­çš„ä¾‹å­

- **å’–å•¡åŠ ç³–ã€åŠ å¥¶**ï¼šåŸºç¡€å’–å•¡ + ç³–è£…é¥°å™¨ + å¥¶è£…é¥°å™¨
- **æ¸¸æˆè£…å¤‡**ï¼šåŸºç¡€è§’è‰² + æ­¦å™¨è£…é¥°å™¨ + é˜²å…·è£…é¥°å™¨
- **Java I/O æµ**ï¼šFileInputStream + BufferedInputStream + DataInputStream

### è£…é¥°å™¨æ¨¡å¼çš„ç»“æ„

```mermaid
classDiagram
    class Component {
        <<interface>>
        +operation()
    }
    class ConcreteComponent {
        +operation()
    }
    class Decorator {
        <<abstract>>
        -component: Component
        +operation()
    }
    class ConcreteDecoratorA {
        +operation()
        +addedBehavior()
    }
    class ConcreteDecoratorB {
        +operation()
        +addedBehavior()
    }
    
    Component <|.. ConcreteComponent
    Component <|.. Decorator
    Decorator <|-- ConcreteDecoratorA
    Decorator <|-- ConcreteDecoratorB
    Decorator --> Component
```

**è§’è‰²è¯´æ˜**ï¼š

| è§’è‰² | è¯´æ˜ |
|------|------|
| **Componentï¼ˆæŠ½è±¡ç»„ä»¶ï¼‰** | å®šä¹‰å¯¹è±¡çš„æ¥å£ï¼Œå¯ä»¥åŠ¨æ€æ·»åŠ èŒè´£ |
| **ConcreteComponentï¼ˆå…·ä½“ç»„ä»¶ï¼‰** | å®šä¹‰å…·ä½“çš„å¯¹è±¡ï¼Œå¯ä»¥ç»™å®ƒæ·»åŠ èŒè´£ |
| **Decoratorï¼ˆæŠ½è±¡è£…é¥°å™¨ï¼‰** | æŒæœ‰ä¸€ä¸ª Component å¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶å®ç° Component æ¥å£ |
| **ConcreteDecoratorï¼ˆå…·ä½“è£…é¥°å™¨ï¼‰** | è´Ÿè´£ç»™ Component æ·»åŠ é¢å¤–çš„èŒè´£ |

---

## 3.2 è£…é¥°å™¨æ¨¡å¼å®ç°

### ç¤ºä¾‹ï¼šå’–å•¡åŠ æ–™ç³»ç»Ÿ

```java
// æŠ½è±¡ç»„ä»¶
interface Coffee {
    String getDescription();
    double getCost();
}

// å…·ä½“ç»„ä»¶
class SimpleCoffee implements Coffee {
    @Override
    public String getDescription() {
        return "ç®€å•å’–å•¡";
    }
    
    @Override
    public double getCost() {
        return 5.0;
    }
}

// æŠ½è±¡è£…é¥°å™¨
abstract class CoffeeDecorator implements Coffee {
    protected Coffee coffee;
    
    public CoffeeDecorator(Coffee coffee) {
        this.coffee = coffee;
    }
    
    @Override
    public String getDescription() {
        return coffee.getDescription();
    }
    
    @Override
    public double getCost() {
        return coffee.getCost();
    }
}

// å…·ä½“è£…é¥°å™¨ï¼šåŠ ç³–
class SugarDecorator extends CoffeeDecorator {
    public SugarDecorator(Coffee coffee) {
        super(coffee);
    }
    
    @Override
    public String getDescription() {
        return coffee.getDescription() + " + ç³–";
    }
    
    @Override
    public double getCost() {
        return coffee.getCost() + 1.0;
    }
}

// å…·ä½“è£…é¥°å™¨ï¼šåŠ å¥¶
class MilkDecorator extends CoffeeDecorator {
    public MilkDecorator(Coffee coffee) {
        super(coffee);
    }
    
    @Override
    public String getDescription() {
        return coffee.getDescription() + " + å¥¶";
    }
    
    @Override
    public double getCost() {
        return coffee.getCost() + 2.0;
    }
}

// å®¢æˆ·ç«¯
public class Client {
    public static void main(String[] args) {
        // ç®€å•å’–å•¡
        Coffee coffee = new SimpleCoffee();
        System.out.println(coffee.getDescription() + " ä»·æ ¼: " + coffee.getCost());
        
        // åŠ ç³–
        coffee = new SugarDecorator(coffee);
        System.out.println(coffee.getDescription() + " ä»·æ ¼: " + coffee.getCost());
        
        // åŠ ç³– + åŠ å¥¶
        coffee = new MilkDecorator(coffee);
        System.out.println(coffee.getDescription() + " ä»·æ ¼: " + coffee.getCost());
    }
}
```

**è¾“å‡º**ï¼š
```
ç®€å•å’–å•¡ ä»·æ ¼: 5.0
ç®€å•å’–å•¡ + ç³– ä»·æ ¼: 6.0
ç®€å•å’–å•¡ + ç³– + å¥¶ ä»·æ ¼: 8.0
```

---

## 3.3 è£…é¥°å™¨æ¨¡å¼ vs ç»§æ‰¿

### ä½¿ç”¨ç»§æ‰¿çš„é—®é¢˜

```java
// âŒ ä½¿ç”¨ç»§æ‰¿ï¼šç±»çˆ†ç‚¸
class Coffee {}
class SugarCoffee extends Coffee {}
class MilkCoffee extends Coffee {}
class SugarMilkCoffee extends Coffee {}
// ... å¦‚æœæœ‰ 10 ç§è°ƒæ–™ï¼Œéœ€è¦ 2^10 = 1024 ä¸ªç±»ï¼
```

### ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼çš„ä¼˜åŠ¿

```java
// âœ… ä½¿ç”¨è£…é¥°å™¨ï¼šçµæ´»ç»„åˆ
Coffee coffee = new SimpleCoffee();
coffee = new SugarDecorator(coffee);
coffee = new MilkDecorator(coffee);
// å¯ä»¥ä»»æ„ç»„åˆï¼Œä¸éœ€è¦åˆ›å»ºæ–°ç±»
```

**è£…é¥°å™¨æ¨¡å¼çš„ä¼˜åŠ¿**ï¼š
- âœ… æ¯”ç»§æ‰¿æ›´çµæ´»ï¼Œå¯ä»¥åŠ¨æ€ç»„åˆåŠŸèƒ½
- âœ… é¿å…ç±»çˆ†ç‚¸ï¼ˆç»„åˆçˆ†ç‚¸ï¼‰
- âœ… ç¬¦åˆå¼€é—­åŸåˆ™ï¼ˆå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼‰

---

## 3.4 è£…é¥°å™¨æ¨¡å¼ vs ä»£ç†æ¨¡å¼

| å¯¹æ¯”é¡¹ | è£…é¥°å™¨æ¨¡å¼ | ä»£ç†æ¨¡å¼ |
|--------|-----------|----------|
| **ç›®çš„** | å¢å¼ºåŠŸèƒ½ | æ§åˆ¶è®¿é—® |
| **å…³æ³¨ç‚¹** | åŠŸèƒ½å¢å¼º | è®¿é—®æ§åˆ¶ã€å»¶è¿ŸåŠ è½½ |
| **å…³ç³»** | è£…é¥°å™¨å’Œè¢«è£…é¥°å¯¹è±¡æ˜¯"is-a"å…³ç³» | ä»£ç†å’Œè¢«ä»£ç†å¯¹è±¡æ˜¯"has-a"å…³ç³» |
| **è°ƒç”¨æ—¶æœº** | è£…é¥°å™¨åœ¨è°ƒç”¨å‰åéƒ½å¯ä»¥å¢å¼º | ä»£ç†é€šå¸¸åœ¨è°ƒç”¨å‰/åè¿›è¡Œæ§åˆ¶ |

**å…³é”®åŒºåˆ«**ï¼š
- **è£…é¥°å™¨**ï¼šå…³æ³¨**å¢å¼ºåŠŸèƒ½**ï¼Œå¯ä»¥å¤šå±‚åµŒå¥—
- **ä»£ç†**ï¼šå…³æ³¨**æ§åˆ¶è®¿é—®**ï¼Œé€šå¸¸åªæœ‰ä¸€å±‚

---

## 3.5 JDK ä¸­çš„è£…é¥°å™¨æ¨¡å¼

**Java I/O æµ** æ˜¯è£…é¥°å™¨æ¨¡å¼çš„ç»å…¸åº”ç”¨ï¼š

```java
// åŸºç¡€ç»„ä»¶
InputStream inputStream = new FileInputStream("file.txt");

// è£…é¥°å™¨ï¼šæ·»åŠ ç¼“å†²åŠŸèƒ½
BufferedInputStream buffered = new BufferedInputStream(inputStream);

// è£…é¥°å™¨ï¼šæ·»åŠ æ•°æ®è¯»å–åŠŸèƒ½
DataInputStream data = new DataInputStream(buffered);

// å¯ä»¥ç»§ç»­åµŒå¥—è£…é¥°å™¨
```

---

# å››ã€ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰

## 4.1 ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼

**ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰** ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚

### ç”Ÿæ´»ä¸­çš„ä¾‹å­

- **æˆ¿äº§ä¸­ä»‹**ï¼šä»£ç†æˆ¿ä¸œï¼Œæ§åˆ¶çœ‹æˆ¿ã€ç­¾çº¦ç­‰è®¿é—®
- **æ˜æ˜Ÿç»çºªäºº**ï¼šä»£ç†æ˜æ˜Ÿï¼Œæ§åˆ¶å•†ä¸šæ´»åŠ¨
- **VPN**ï¼šä»£ç†æœåŠ¡å™¨ï¼Œæ§åˆ¶ç½‘ç»œè®¿é—®

### ä»£ç†æ¨¡å¼çš„ç»“æ„

```mermaid
classDiagram
    class Subject {
        <<interface>>
        +request()
    }
    class RealSubject {
        +request()
    }
    class Proxy {
        -realSubject: RealSubject
        +request()
        -preRequest()
        -postRequest()
    }
    class Client {
        +main()
    }
    
    Client --> Subject
    Proxy ..|> Subject
    Proxy --> RealSubject
    RealSubject ..|> Subject
```

**è§’è‰²è¯´æ˜**ï¼š

| è§’è‰² | è¯´æ˜ |
|------|------|
| **Subjectï¼ˆæŠ½è±¡ä¸»é¢˜ï¼‰** | å®šä¹‰ä»£ç†å’ŒçœŸå®å¯¹è±¡çš„å…±åŒæ¥å£ |
| **RealSubjectï¼ˆçœŸå®ä¸»é¢˜ï¼‰** | å®šä¹‰ä»£ç†æ‰€ä»£è¡¨çš„çœŸå®å¯¹è±¡ |
| **Proxyï¼ˆä»£ç†ï¼‰** | æŒæœ‰çœŸå®å¯¹è±¡çš„å¼•ç”¨ï¼Œæ§åˆ¶å¯¹çœŸå®å¯¹è±¡çš„è®¿é—® |

---

## 4.2 ä»£ç†æ¨¡å¼çš„ä¸‰ç§å®ç°æ–¹å¼

### 4.2.1 é™æ€ä»£ç†

**æ ¸å¿ƒ**ï¼šä»£ç†ç±»åœ¨ç¼–è¯‘æœŸå°±å·²ç»ç¡®å®šã€‚

```java
// æŠ½è±¡ä¸»é¢˜
interface Subject {
    void request();
}

// çœŸå®ä¸»é¢˜
class RealSubject implements Subject {
    @Override
    public void request() {
        System.out.println("çœŸå®å¯¹è±¡çš„è¯·æ±‚");
    }
}

// é™æ€ä»£ç†
class StaticProxy implements Subject {
    private RealSubject realSubject;
    
    public StaticProxy(RealSubject realSubject) {
        this.realSubject = realSubject;
    }
    
    @Override
    public void request() {
        preRequest();
        realSubject.request();
        postRequest();
    }
    
    private void preRequest() {
        System.out.println("ä»£ç†ï¼šè¯·æ±‚å‰å¤„ç†");
    }
    
    private void postRequest() {
        System.out.println("ä»£ç†ï¼šè¯·æ±‚åå¤„ç†");
    }
}

// å®¢æˆ·ç«¯
public class Client {
    public static void main(String[] args) {
        RealSubject realSubject = new RealSubject();
        Subject proxy = new StaticProxy(realSubject);
        proxy.request();
    }
}
```

**è¾“å‡º**ï¼š
```
ä»£ç†ï¼šè¯·æ±‚å‰å¤„ç†
çœŸå®å¯¹è±¡çš„è¯·æ±‚
ä»£ç†ï¼šè¯·æ±‚åå¤„ç†
```

**é™æ€ä»£ç†çš„ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦ä¸ºæ¯ä¸ªè¢«ä»£ç†ç±»åˆ›å»ºä¸€ä¸ªä»£ç†ç±»ï¼Œä»£ç é‡å¤§
- âŒ å¦‚æœæ¥å£æ–¹æ³•å¾ˆå¤šï¼Œä»£ç†ç±»ä¼šå¾ˆè‡ƒè‚¿

---

### 4.2.2 JDK åŠ¨æ€ä»£ç† â­ **é‡ç‚¹**

**æ ¸å¿ƒ**ï¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼Œä½¿ç”¨ `java.lang.reflect.Proxy` å’Œ `InvocationHandler`ã€‚

```java
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;

// æŠ½è±¡ä¸»é¢˜
interface Subject {
    void request();
    void doSomething();
}

// çœŸå®ä¸»é¢˜
class RealSubject implements Subject {
    @Override
    public void request() {
        System.out.println("çœŸå®å¯¹è±¡çš„è¯·æ±‚");
    }
    
    @Override
    public void doSomething() {
        System.out.println("çœŸå®å¯¹è±¡åšæŸäº‹");
    }
}

// åŠ¨æ€ä»£ç†å¤„ç†å™¨
class DynamicProxyHandler implements InvocationHandler {
    private Object target;
    
    public DynamicProxyHandler(Object target) {
        this.target = target;
    }
    
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        System.out.println("ä»£ç†ï¼šè°ƒç”¨æ–¹æ³•å‰ - " + method.getName());
        Object result = method.invoke(target, args);
        System.out.println("ä»£ç†ï¼šè°ƒç”¨æ–¹æ³•å - " + method.getName());
        return result;
    }
}

// å®¢æˆ·ç«¯
public class Client {
    public static void main(String[] args) {
        RealSubject realSubject = new RealSubject();
        
        // åˆ›å»ºåŠ¨æ€ä»£ç†
        Subject proxy = (Subject) Proxy.newProxyInstance(
            realSubject.getClass().getClassLoader(),  // ç±»åŠ è½½å™¨
            realSubject.getClass().getInterfaces(),   // æ¥å£æ•°ç»„
            new DynamicProxyHandler(realSubject)      // è°ƒç”¨å¤„ç†å™¨
        );
        
        proxy.request();
        proxy.doSomething();
    }
}
```

**è¾“å‡º**ï¼š
```
ä»£ç†ï¼šè°ƒç”¨æ–¹æ³•å‰ - request
çœŸå®å¯¹è±¡çš„è¯·æ±‚
ä»£ç†ï¼šè°ƒç”¨æ–¹æ³•å - request
ä»£ç†ï¼šè°ƒç”¨æ–¹æ³•å‰ - doSomething
çœŸå®å¯¹è±¡åšæŸäº‹
ä»£ç†ï¼šè°ƒç”¨æ–¹æ³•å - doSomething
```

**JDK åŠ¨æ€ä»£ç†çš„ç‰¹ç‚¹**ï¼š
- âœ… åªéœ€è¦ä¸€ä¸ª `InvocationHandler`ï¼Œå¯ä»¥ä»£ç†æ‰€æœ‰æ¥å£
- âœ… åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»
- âŒ **åªèƒ½ä»£ç†æ¥å£**ï¼Œä¸èƒ½ä»£ç†ç±»ï¼ˆå› ä¸º Java ä¸æ”¯æŒå¤šç»§æ‰¿ï¼‰

---

### 4.2.3 CGLIB åŠ¨æ€ä»£ç† â­ **é‡ç‚¹**

**æ ¸å¿ƒ**ï¼šä½¿ç”¨å­—èŠ‚ç æŠ€æœ¯ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆè¢«ä»£ç†ç±»çš„å­ç±»ã€‚

**éœ€è¦å¼•å…¥ä¾èµ–**ï¼š
```xml
<dependency>
    <groupId>cglib</groupId>
    <artifactId>cglib</artifactId>
    <version>3.3.0</version>
</dependency>
```

```java
import net.sf.cglib.proxy.Enhancer;
import net.sf.cglib.proxy.MethodInterceptor;
import net.sf.cglib.proxy.MethodProxy;

// çœŸå®ä¸»é¢˜ï¼ˆæ³¨æ„ï¼šä¸éœ€è¦å®ç°æ¥å£ï¼‰
class RealSubject {
    public void request() {
        System.out.println("çœŸå®å¯¹è±¡çš„è¯·æ±‚");
    }
    
    public void doSomething() {
        System.out.println("çœŸå®å¯¹è±¡åšæŸäº‹");
    }
}

// CGLIB æ–¹æ³•æ‹¦æˆªå™¨
class CglibProxyInterceptor implements MethodInterceptor {
    @Override
    public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable {
        System.out.println("CGLIBä»£ç†ï¼šè°ƒç”¨æ–¹æ³•å‰ - " + method.getName());
        Object result = proxy.invokeSuper(obj, args);
        System.out.println("CGLIBä»£ç†ï¼šè°ƒç”¨æ–¹æ³•å - " + method.getName());
        return result;
    }
}

// å®¢æˆ·ç«¯
public class Client {
    public static void main(String[] args) {
        Enhancer enhancer = new Enhancer();
        enhancer.setSuperclass(RealSubject.class);
        enhancer.setCallback(new CglibProxyInterceptor());
        
        RealSubject proxy = (RealSubject) enhancer.create();
        proxy.request();
        proxy.doSomething();
    }
}
```

**CGLIB åŠ¨æ€ä»£ç†çš„ç‰¹ç‚¹**ï¼š
- âœ… **å¯ä»¥ä»£ç†ç±»**ï¼Œä¸éœ€è¦å®ç°æ¥å£
- âœ… åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»çš„å­ç±»
- âŒ ä¸èƒ½ä»£ç† final ç±»å’Œæ–¹æ³•ï¼ˆå› ä¸ºéœ€è¦ç»§æ‰¿ï¼‰

---

## 4.3 JDK åŠ¨æ€ä»£ç† vs CGLIB åŠ¨æ€ä»£ç†

| å¯¹æ¯”é¡¹ | JDK åŠ¨æ€ä»£ç† | CGLIB åŠ¨æ€ä»£ç† |
|--------|-------------|---------------|
| **åŸç†** | åŸºäºæ¥å£ï¼Œä½¿ç”¨åå°„ | åŸºäºç»§æ‰¿ï¼Œä½¿ç”¨å­—èŠ‚ç æŠ€æœ¯ |
| **ä»£ç†å¯¹è±¡** | æ¥å£çš„å®ç°ç±» | ç±»çš„å­ç±» |
| **æ€§èƒ½** | è¾ƒæ…¢ï¼ˆåå°„è°ƒç”¨ï¼‰ | è¾ƒå¿«ï¼ˆç›´æ¥è°ƒç”¨ï¼‰ |
| **é™åˆ¶** | åªèƒ½ä»£ç†æ¥å£ | ä¸èƒ½ä»£ç† final ç±»å’Œæ–¹æ³• |
| **ä¾èµ–** | JDK è‡ªå¸¦ | éœ€è¦å¼•å…¥ CGLIB |

**Spring AOP çš„é€‰æ‹©**ï¼š
- å¦‚æœç›®æ ‡å¯¹è±¡å®ç°äº†æ¥å£ï¼Œé»˜è®¤ä½¿ç”¨ **JDK åŠ¨æ€ä»£ç†**
- å¦‚æœç›®æ ‡å¯¹è±¡æ²¡æœ‰å®ç°æ¥å£ï¼Œä½¿ç”¨ **CGLIB åŠ¨æ€ä»£ç†**
- å¯ä»¥é€šè¿‡é…ç½®å¼ºåˆ¶ä½¿ç”¨ CGLIBï¼š`@EnableAspectJAutoProxy(proxyTargetClass = true)`

---

## 4.4 ä»£ç†æ¨¡å¼çš„åº”ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå»¶è¿ŸåŠ è½½ï¼ˆLazy Loadingï¼‰

```java
class ImageProxy implements Image {
    private String filename;
    private RealImage realImage;
    
    public ImageProxy(String filename) {
        this.filename = filename;
    }
    
    @Override
    public void display() {
        if (realImage == null) {
            realImage = new RealImage(filename); // å»¶è¿ŸåŠ è½½
        }
        realImage.display();
    }
}
```

### åœºæ™¯2ï¼šè®¿é—®æ§åˆ¶

```java
class AccessProxy implements Database {
    private RealDatabase realDatabase;
    private String userRole;
    
    @Override
    public void query(String sql) {
        if ("admin".equals(userRole)) {
            realDatabase.query(sql);
        } else {
            throw new SecurityException("æ— æƒé™è®¿é—®");
        }
    }
}
```

### åœºæ™¯3ï¼šSpring AOP

Spring AOP å°±æ˜¯åŸºäºä»£ç†æ¨¡å¼å®ç°çš„ï¼š
- ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†æˆ– CGLIB åŠ¨æ€ä»£ç†
- åœ¨æ–¹æ³•è°ƒç”¨å‰åæ·»åŠ æ¨ªåˆ‡é€»è¾‘ï¼ˆæ—¥å¿—ã€äº‹åŠ¡ã€æƒé™ç­‰ï¼‰

---

# äº”ã€å¤–è§‚æ¨¡å¼ï¼ˆFacadeï¼‰

## 5.1 ä»€ä¹ˆæ˜¯å¤–è§‚æ¨¡å¼

**å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰** ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ã€‚å¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚

### ç”Ÿæ´»ä¸­çš„ä¾‹å­

- **åŒ»é™¢å‰å°**ï¼šç»Ÿä¸€å¤„ç†æŒ‚å·ã€ç¼´è´¹ã€å–è¯ç­‰å¤æ‚æµç¨‹
- **ä¸€é”®å¯åŠ¨ç”µè„‘**ï¼šå°è£…äº† BIOSã€æ“ä½œç³»ç»Ÿå¯åŠ¨ç­‰å¤æ‚è¿‡ç¨‹
- **API ç½‘å…³**ï¼šä¸ºå¤šä¸ªå¾®æœåŠ¡æä¾›ç»Ÿä¸€çš„å…¥å£

### å¤–è§‚æ¨¡å¼çš„ç»“æ„

```mermaid
classDiagram
    class Facade {
        -subsystemA: SubsystemA
        -subsystemB: SubsystemB
        -subsystemC: SubsystemC
        +operation()
    }
    class SubsystemA {
        +operationA()
    }
    class SubsystemB {
        +operationB()
    }
    class SubsystemC {
        +operationC()
    }
    class Client {
        +main()
    }
    
    Client --> Facade
    Facade --> SubsystemA
    Facade --> SubsystemB
    Facade --> SubsystemC
```

**è§’è‰²è¯´æ˜**ï¼š

| è§’è‰² | è¯´æ˜ |
|------|------|
| **Facadeï¼ˆå¤–è§‚ï¼‰** | ä¸ºå­ç³»ç»Ÿæä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ |
| **Subsystemï¼ˆå­ç³»ç»Ÿï¼‰** | å®ç°å­ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œå¤„ç† Facade æŒ‡æ´¾çš„ä»»åŠ¡ |

---

## 5.2 å¤–è§‚æ¨¡å¼å®ç°

### ç¤ºä¾‹ï¼šå®¶åº­å½±é™¢ç³»ç»Ÿ

```java
// å­ç³»ç»Ÿ1ï¼šDVD æ’­æ”¾å™¨
class DVDPlayer {
    public void on() {
        System.out.println("DVD æ’­æ”¾å™¨æ‰“å¼€");
    }
    
    public void play(String movie) {
        System.out.println("DVD æ’­æ”¾å™¨æ’­æ”¾: " + movie);
    }
    
    public void off() {
        System.out.println("DVD æ’­æ”¾å™¨å…³é—­");
    }
}

// å­ç³»ç»Ÿ2ï¼šæŠ•å½±ä»ª
class Projector {
    public void on() {
        System.out.println("æŠ•å½±ä»ªæ‰“å¼€");
    }
    
    public void off() {
        System.out.println("æŠ•å½±ä»ªå…³é—­");
    }
}

// å­ç³»ç»Ÿ3ï¼šéŸ³å“
class SoundSystem {
    public void on() {
        System.out.println("éŸ³å“æ‰“å¼€");
    }
    
    public void setVolume(int volume) {
        System.out.println("éŸ³å“éŸ³é‡è®¾ç½®ä¸º: " + volume);
    }
    
    public void off() {
        System.out.println("éŸ³å“å…³é—­");
    }
}

// å¤–è§‚ï¼šå®¶åº­å½±é™¢
class HomeTheaterFacade {
    private DVDPlayer dvdPlayer;
    private Projector projector;
    private SoundSystem soundSystem;
    
    public HomeTheaterFacade(DVDPlayer dvd, Projector proj, SoundSystem sound) {
        this.dvdPlayer = dvd;
        this.projector = proj;
        this.soundSystem = sound;
    }
    
    // ä¸€é”®çœ‹ç”µå½±
    public void watchMovie(String movie) {
        System.out.println("å‡†å¤‡çœ‹ç”µå½±...");
        projector.on();
        dvdPlayer.on();
        soundSystem.on();
        soundSystem.setVolume(10);
        dvdPlayer.play(movie);
    }
    
    // ä¸€é”®å…³é—­
    public void endMovie() {
        System.out.println("å…³é—­å®¶åº­å½±é™¢...");
        dvdPlayer.off();
        projector.off();
        soundSystem.off();
    }
}

// å®¢æˆ·ç«¯
public class Client {
    public static void main(String[] args) {
        DVDPlayer dvd = new DVDPlayer();
        Projector projector = new Projector();
        SoundSystem sound = new SoundSystem();
        
        HomeTheaterFacade facade = new HomeTheaterFacade(dvd, projector, sound);
        facade.watchMovie("å¤ä»‡è€…è”ç›Ÿ");
        facade.endMovie();
    }
}
```

**è¾“å‡º**ï¼š
```
å‡†å¤‡çœ‹ç”µå½±...
æŠ•å½±ä»ªæ‰“å¼€
DVD æ’­æ”¾å™¨æ‰“å¼€
éŸ³å“æ‰“å¼€
éŸ³å“éŸ³é‡è®¾ç½®ä¸º: 10
DVD æ’­æ”¾å™¨æ’­æ”¾: å¤ä»‡è€…è”ç›Ÿ
å…³é—­å®¶åº­å½±é™¢...
DVD æ’­æ”¾å™¨å…³é—­
æŠ•å½±ä»ªå…³é—­
éŸ³å“å…³é—­
```

---

## 5.3 å¤–è§‚æ¨¡å¼ vs é€‚é…å™¨æ¨¡å¼

| å¯¹æ¯”é¡¹ | å¤–è§‚æ¨¡å¼ | é€‚é…å™¨æ¨¡å¼ |
|--------|---------|-----------|
| **ç›®çš„** | ç®€åŒ–æ¥å£ï¼Œæä¾›ç»Ÿä¸€å…¥å£ | è½¬æ¢æ¥å£ï¼Œè®©ä¸å…¼å®¹çš„æ¥å£ååŒå·¥ä½œ |
| **å…³æ³¨ç‚¹** | ç®€åŒ–ä½¿ç”¨ | æ¥å£è½¬æ¢ |
| **å…³ç³»** | å¤–è§‚æ˜¯å­ç³»ç»Ÿçš„å…¥å£ | é€‚é…å™¨æ˜¯æ¥å£çš„è½¬æ¢å™¨ |

---

## 5.4 å®é™…åº”ç”¨åœºæ™¯

### åœºæ™¯1ï¼šAPI ç½‘å…³

API ç½‘å…³ä¸ºå¤šä¸ªå¾®æœåŠ¡æä¾›ç»Ÿä¸€çš„å…¥å£ï¼Œç®€åŒ–å®¢æˆ·ç«¯çš„è°ƒç”¨ã€‚

### åœºæ™¯2ï¼šSpring MVC çš„ DispatcherServlet

`DispatcherServlet` ä½œä¸ºå‰ç«¯æ§åˆ¶å™¨ï¼Œç»Ÿä¸€å¤„ç†è¯·æ±‚ï¼Œç®€åŒ–äº† Spring MVC çš„ä½¿ç”¨ã€‚

---

# å…­ã€æ¡¥æ¥æ¨¡å¼ï¼ˆBridgeï¼‰

## 6.1 ä»€ä¹ˆæ˜¯æ¡¥æ¥æ¨¡å¼

**æ¡¥æ¥æ¨¡å¼ï¼ˆBridge Patternï¼‰** å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚

### ç”Ÿæ´»ä¸­çš„ä¾‹å­

- **é¥æ§å™¨å’Œç”µè§†**ï¼šé¥æ§å™¨ï¼ˆæŠ½è±¡ï¼‰å¯ä»¥æ§åˆ¶ä¸åŒå“ç‰Œçš„ç”µè§†ï¼ˆå®ç°ï¼‰
- **ç¬”å’Œé¢œè‰²**ï¼šç¬”ï¼ˆæŠ½è±¡ï¼‰å¯ä»¥ä½¿ç”¨ä¸åŒé¢œè‰²ï¼ˆå®ç°ï¼‰çš„å¢¨æ°´
- **æ“ä½œç³»ç»Ÿå’Œé©±åŠ¨ç¨‹åº**ï¼šæ“ä½œç³»ç»Ÿï¼ˆæŠ½è±¡ï¼‰å¯ä»¥ä½¿ç”¨ä¸åŒç¡¬ä»¶ï¼ˆå®ç°ï¼‰çš„é©±åŠ¨

### æ¡¥æ¥æ¨¡å¼çš„ç»“æ„

```mermaid
classDiagram
    class Abstraction {
        -implementor: Implementor
        +operation()
    }
    class RefinedAbstraction {
        +operation()
    }
    class Implementor {
        <<interface>>
        +operationImpl()
    }
    class ConcreteImplementorA {
        +operationImpl()
    }
    class ConcreteImplementorB {
        +operationImpl()
    }
    
    Abstraction --> Implementor
    RefinedAbstraction --|> Abstraction
    Implementor <|.. ConcreteImplementorA
    Implementor <|.. ConcreteImplementorB
```

**è§’è‰²è¯´æ˜**ï¼š

| è§’è‰² | è¯´æ˜ |
|------|------|
| **Abstractionï¼ˆæŠ½è±¡ç±»ï¼‰** | å®šä¹‰æŠ½è±¡æ¥å£ï¼ŒæŒæœ‰ Implementor çš„å¼•ç”¨ |
| **RefinedAbstractionï¼ˆæ‰©å……æŠ½è±¡ç±»ï¼‰** | æ‰©å±• Abstraction çš„æ¥å£ |
| **Implementorï¼ˆå®ç°ç±»æ¥å£ï¼‰** | å®šä¹‰å®ç°ç±»çš„æ¥å£ |
| **ConcreteImplementorï¼ˆå…·ä½“å®ç°ç±»ï¼‰** | å®ç° Implementor æ¥å£ |

---

## 6.2 æ¡¥æ¥æ¨¡å¼å®ç°

### ç¤ºä¾‹ï¼šä¸åŒå½¢çŠ¶å’Œé¢œè‰²çš„å›¾å½¢

```java
// å®ç°ç±»æ¥å£ï¼šé¢œè‰²
interface Color {
    void applyColor();
}

// å…·ä½“å®ç°ç±»ï¼šçº¢è‰²
class RedColor implements Color {
    @Override
    public void applyColor() {
        System.out.print("çº¢è‰²");
    }
}

// å…·ä½“å®ç°ç±»ï¼šè“è‰²
class BlueColor implements Color {
    @Override
    public void applyColor() {
        System.out.print("è“è‰²");
    }
}

// æŠ½è±¡ç±»ï¼šå½¢çŠ¶
abstract class Shape {
    protected Color color;
    
    public Shape(Color color) {
        this.color = color;
    }
    
    abstract void draw();
}

// æ‰©å……æŠ½è±¡ç±»ï¼šåœ†å½¢
class Circle extends Shape {
    public Circle(Color color) {
        super(color);
    }
    
    @Override
    void draw() {
        color.applyColor();
        System.out.println("åœ†å½¢");
    }
}

// æ‰©å……æŠ½è±¡ç±»ï¼šçŸ©å½¢
class Rectangle extends Shape {
    public Rectangle(Color color) {
        super(color);
    }
    
    @Override
    void draw() {
        color.applyColor();
        System.out.println("çŸ©å½¢");
    }
}

// å®¢æˆ·ç«¯
public class Client {
    public static void main(String[] args) {
        // çº¢è‰²åœ†å½¢
        Shape redCircle = new Circle(new RedColor());
        redCircle.draw();
        
        // è“è‰²çŸ©å½¢
        Shape blueRectangle = new Rectangle(new BlueColor());
        blueRectangle.draw();
    }
}
```

**è¾“å‡º**ï¼š
```
çº¢è‰²åœ†å½¢
è“è‰²çŸ©å½¢
```

---

## 6.3 æ¡¥æ¥æ¨¡å¼çš„ä¼˜åŠ¿

**ä¸ä½¿ç”¨æ¡¥æ¥æ¨¡å¼çš„é—®é¢˜**ï¼ˆç±»çˆ†ç‚¸ï¼‰ï¼š

```java
// âŒ éœ€è¦ä¸ºæ¯ç§ç»„åˆåˆ›å»ºç±»
class RedCircle {}
class BlueCircle {}
class RedRectangle {}
class BlueRectangle {}
// å¦‚æœæœ‰ 3 ç§å½¢çŠ¶ Ã— 5 ç§é¢œè‰² = 15 ä¸ªç±»ï¼
```

**ä½¿ç”¨æ¡¥æ¥æ¨¡å¼çš„ä¼˜åŠ¿**ï¼š

```java
// âœ… åªéœ€è¦ 3 + 5 = 8 ä¸ªç±»
// 3 ä¸ªå½¢çŠ¶ç±» + 5 ä¸ªé¢œè‰²ç±»ï¼Œå¯ä»¥ä»»æ„ç»„åˆ
```

**æ¡¥æ¥æ¨¡å¼çš„æ ¸å¿ƒä»·å€¼**ï¼š
- âœ… å°†æŠ½è±¡å’Œå®ç°åˆ†ç¦»ï¼Œå¯ä»¥ç‹¬ç«‹æ‰©å±•
- âœ… é¿å…ç±»çˆ†ç‚¸ï¼ˆç»„åˆçˆ†ç‚¸ï¼‰
- âœ… ç¬¦åˆå¼€é—­åŸåˆ™

---

## 6.4 æ¡¥æ¥æ¨¡å¼ vs é€‚é…å™¨æ¨¡å¼

| å¯¹æ¯”é¡¹ | æ¡¥æ¥æ¨¡å¼ | é€‚é…å™¨æ¨¡å¼ |
|--------|---------|-----------|
| **ç›®çš„** | åˆ†ç¦»æŠ½è±¡å’Œå®ç°ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ– | è½¬æ¢æ¥å£ï¼Œè®©ä¸å…¼å®¹çš„æ¥å£ååŒå·¥ä½œ |
| **ä½¿ç”¨æ—¶æœº** | è®¾è®¡é˜¶æ®µï¼Œé¢„å…ˆè®¾è®¡ | å·²æœ‰ç³»ç»Ÿï¼Œéœ€è¦é€‚é… |
| **å…³æ³¨ç‚¹** | ç»“æ„è®¾è®¡ | æ¥å£è½¬æ¢ |

---

# ä¸ƒã€ç»„åˆæ¨¡å¼ï¼ˆCompositeï¼‰

## 7.1 ä»€ä¹ˆæ˜¯ç»„åˆæ¨¡å¼

**ç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰** å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤º"éƒ¨åˆ†-æ•´ä½“"çš„å±‚æ¬¡ç»“æ„ã€‚ç»„åˆæ¨¡å¼ä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚

### ç”Ÿæ´»ä¸­çš„ä¾‹å­

- **æ–‡ä»¶ç³»ç»Ÿ**ï¼šæ–‡ä»¶å’Œæ–‡ä»¶å¤¹éƒ½æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„ç»„æˆéƒ¨åˆ†
- **ç»„ç»‡æ¶æ„**ï¼šéƒ¨é—¨å’Œå‘˜å·¥éƒ½æ˜¯ç»„ç»‡çš„ç»„æˆéƒ¨åˆ†
- **èœå•ç³»ç»Ÿ**ï¼šèœå•é¡¹å’Œå­èœå•éƒ½æ˜¯èœå•çš„ç»„æˆéƒ¨åˆ†

### ç»„åˆæ¨¡å¼çš„ç»“æ„

```mermaid
classDiagram
    class Component {
        <<interface>>
        +operation()
        +add(Component)
        +remove(Component)
        +getChild(int)
    }
    class Leaf {
        +operation()
    }
    class Composite {
        -children: List~Component~
        +operation()
        +add(Component)
        +remove(Component)
        +getChild(int)
    }
    
    Component <|.. Leaf
    Component <|.. Composite
    Composite --> Component
```

---

## 7.2 ç»„åˆæ¨¡å¼å®ç°ï¼ˆç®€è¦ï¼‰

```java
// æŠ½è±¡ç»„ä»¶
interface Component {
    void operation();
}

// å¶å­èŠ‚ç‚¹
class Leaf implements Component {
    private String name;
    
    public Leaf(String name) {
        this.name = name;
    }
    
    @Override
    public void operation() {
        System.out.println("å¶å­èŠ‚ç‚¹: " + name);
    }
}

// ç»„åˆèŠ‚ç‚¹
class Composite implements Component {
    private List<Component> children = new ArrayList<>();
    private String name;
    
    public Composite(String name) {
        this.name = name;
    }
    
    public void add(Component component) {
        children.add(component);
    }
    
    @Override
    public void operation() {
        System.out.println("ç»„åˆèŠ‚ç‚¹: " + name);
        for (Component child : children) {
            child.operation();
        }
    }
}
```

> **æ³¨æ„**ï¼šç»„åˆæ¨¡å¼äº†è§£å³å¯ï¼Œé¢è¯•ä¸­è¾ƒå°‘æ¶‰åŠã€‚

---

# å…«ã€äº«å…ƒæ¨¡å¼ï¼ˆFlyweightï¼‰

## 8.1 ä»€ä¹ˆæ˜¯äº«å…ƒæ¨¡å¼

**äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Patternï¼‰** è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚

### ç”Ÿæ´»ä¸­çš„ä¾‹å­

- **å›´æ£‹æ£‹å­**ï¼šé»‘å­å’Œç™½å­å¯ä»¥å…±äº«ï¼Œåªéœ€è¦å­˜å‚¨ä½ç½®ä¿¡æ¯
- **å­—ç¬¦å¯¹è±¡**ï¼šç›¸åŒå­—ç¬¦å¯ä»¥å…±äº«ï¼Œåªéœ€è¦å­˜å‚¨å­—ç¬¦å€¼
- **æ•°æ®åº“è¿æ¥æ± **ï¼šå…±äº«æ•°æ®åº“è¿æ¥ï¼Œé¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯

### äº«å…ƒæ¨¡å¼çš„ç»“æ„

```mermaid
classDiagram
    class Flyweight {
        <<interface>>
        +operation(extrinsicState)
    }
    class ConcreteFlyweight {
        -intrinsicState
        +operation(extrinsicState)
    }
    class FlyweightFactory {
        -flyweights: Map
        +getFlyweight(key)
    }
    class Client {
        +main()
    }
    
    Client --> FlyweightFactory
    FlyweightFactory --> Flyweight
    Flyweight <|.. ConcreteFlyweight
```

---

## 8.2 äº«å…ƒæ¨¡å¼å®ç°ï¼ˆç®€è¦ï¼‰

```java
// äº«å…ƒæ¥å£
interface Flyweight {
    void operation(String extrinsicState);
}

// å…·ä½“äº«å…ƒ
class ConcreteFlyweight implements Flyweight {
    private String intrinsicState; // å†…éƒ¨çŠ¶æ€ï¼ˆå¯å…±äº«ï¼‰
    
    public ConcreteFlyweight(String intrinsicState) {
        this.intrinsicState = intrinsicState;
    }
    
    @Override
    public void operation(String extrinsicState) {
        System.out.println("å†…éƒ¨çŠ¶æ€: " + intrinsicState + ", å¤–éƒ¨çŠ¶æ€: " + extrinsicState);
    }
}

// äº«å…ƒå·¥å‚
class FlyweightFactory {
    private Map<String, Flyweight> flyweights = new HashMap<>();
    
    public Flyweight getFlyweight(String key) {
        if (!flyweights.containsKey(key)) {
            flyweights.put(key, new ConcreteFlyweight(key));
        }
        return flyweights.get(key);
    }
}
```

> **æ³¨æ„**ï¼šäº«å…ƒæ¨¡å¼äº†è§£å³å¯ï¼Œé¢è¯•ä¸­è¾ƒå°‘æ¶‰åŠã€‚

---

# ä¹ã€ç»“æ„å‹æ¨¡å¼åœ¨ Spring/JDK ä¸­çš„åº”ç”¨æ€»ç»“

## 9.1 é€‚é…å™¨æ¨¡å¼

| åº”ç”¨ | è¯´æ˜ |
|------|------|
| **InputStreamReader** | å°†å­—èŠ‚æµï¼ˆInputStreamï¼‰é€‚é…æˆå­—ç¬¦æµï¼ˆReaderï¼‰ |
| **Spring MVC HandlerAdapter** | å°†ä¸åŒçš„ Controller é€‚é…æˆç»Ÿä¸€çš„ HandlerAdapter æ¥å£ |

---

## 9.2 è£…é¥°å™¨æ¨¡å¼

| åº”ç”¨ | è¯´æ˜ |
|------|------|
| **Java I/O æµ** | `BufferedInputStream`ã€`DataInputStream` ç­‰éƒ½æ˜¯è£…é¥°å™¨ |
| **Java Collections** | `Collections.unmodifiableList()` è¿”å›è£…é¥°å™¨ |

---

## 9.3 ä»£ç†æ¨¡å¼

| åº”ç”¨ | è¯´æ˜ |
|------|------|
| **Spring AOP** | ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†æˆ– CGLIB åŠ¨æ€ä»£ç†å®ç° AOP |
| **MyBatis** | Mapper æ¥å£ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†å®ç° |
| **Spring äº‹åŠ¡** | é€šè¿‡ä»£ç†å®ç°äº‹åŠ¡ç®¡ç† |

---

## 9.4 å¤–è§‚æ¨¡å¼

| åº”ç”¨ | è¯´æ˜ |
|------|------|
| **Spring MVC DispatcherServlet** | ä½œä¸ºå‰ç«¯æ§åˆ¶å™¨ï¼Œç»Ÿä¸€å¤„ç†è¯·æ±‚ |
| **SLF4J** | ä¸ºä¸åŒçš„æ—¥å¿—æ¡†æ¶æä¾›ç»Ÿä¸€çš„æ¥å£ |

---

## 9.5 æ¡¥æ¥æ¨¡å¼

| åº”ç”¨ | è¯´æ˜ |
|------|------|
| **JDBC é©±åŠ¨** | JDBC æ¥å£ï¼ˆæŠ½è±¡ï¼‰å’Œå…·ä½“æ•°æ®åº“é©±åŠ¨ï¼ˆå®ç°ï¼‰åˆ†ç¦» |

---

# åã€é¢è¯•é«˜é¢‘é—®é¢˜

## 10.1 é€‚é…å™¨æ¨¡å¼ç›¸å…³

**Q1ï¼šä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜ã€‚**

**A**ï¼šé€‚é…å™¨æ¨¡å¼å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ã€‚ä¾‹å¦‚ï¼Œ`InputStreamReader` å°†å­—èŠ‚æµé€‚é…æˆå­—ç¬¦æµã€‚

---

**Q2ï¼šç±»é€‚é…å™¨å’Œå¯¹è±¡é€‚é…å™¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

**A**ï¼š
- **ç±»é€‚é…å™¨**ï¼šä½¿ç”¨ç»§æ‰¿ï¼ŒAdapter ç»§æ‰¿ Adaptee å¹¶å®ç° Target
- **å¯¹è±¡é€‚é…å™¨**ï¼šä½¿ç”¨ç»„åˆï¼ŒAdapter æŒæœ‰ Adaptee çš„å¼•ç”¨å¹¶å®ç° Target
- **æ¨èä½¿ç”¨å¯¹è±¡é€‚é…å™¨**ï¼Œå› ä¸ºæ›´çµæ´»ï¼Œç¬¦åˆç»„åˆä¼˜äºç»§æ‰¿çš„åŸåˆ™

---

## 10.2 è£…é¥°å™¨æ¨¡å¼ç›¸å…³

**Q3ï¼šè£…é¥°å™¨æ¨¡å¼å’Œç»§æ‰¿æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

**A**ï¼š
- **ç»§æ‰¿**ï¼šç¼–è¯‘æœŸç¡®å®šï¼Œç±»çˆ†ç‚¸é—®é¢˜ï¼ˆå¦‚æœæœ‰ 10 ç§è°ƒæ–™ï¼Œéœ€è¦ 2^10 ä¸ªç±»ï¼‰
- **è£…é¥°å™¨**ï¼šè¿è¡ŒæœŸç»„åˆï¼Œçµæ´»ï¼ˆå¯ä»¥ä»»æ„ç»„åˆï¼Œä¸éœ€è¦åˆ›å»ºæ–°ç±»ï¼‰

---

**Q4ï¼šè£…é¥°å™¨æ¨¡å¼å’Œä»£ç†æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

**A**ï¼š
- **è£…é¥°å™¨**ï¼šå…³æ³¨**å¢å¼ºåŠŸèƒ½**ï¼Œå¯ä»¥å¤šå±‚åµŒå¥—
- **ä»£ç†**ï¼šå…³æ³¨**æ§åˆ¶è®¿é—®**ï¼Œé€šå¸¸åªæœ‰ä¸€å±‚

---

**Q5ï¼šJava I/O æµä¸­å“ªäº›æ˜¯è£…é¥°å™¨æ¨¡å¼ï¼Ÿ**

**A**ï¼š`BufferedInputStream`ã€`DataInputStream`ã€`BufferedOutputStream` ç­‰éƒ½æ˜¯è£…é¥°å™¨ï¼Œå®ƒä»¬è£…é¥°äº†åŸºç¡€çš„ `InputStream`/`OutputStream`ã€‚

---

## 10.3 ä»£ç†æ¨¡å¼ç›¸å…³

**Q6ï¼šä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼ï¼Ÿæœ‰å“ªäº›å®ç°æ–¹å¼ï¼Ÿ**

**A**ï¼šä»£ç†æ¨¡å¼ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚æœ‰ä¸‰ç§å®ç°æ–¹å¼ï¼š
1. **é™æ€ä»£ç†**ï¼šç¼–è¯‘æœŸç¡®å®šä»£ç†ç±»
2. **JDK åŠ¨æ€ä»£ç†**ï¼šåŸºäºæ¥å£ï¼Œä½¿ç”¨åå°„
3. **CGLIB åŠ¨æ€ä»£ç†**ï¼šåŸºäºç»§æ‰¿ï¼Œä½¿ç”¨å­—èŠ‚ç æŠ€æœ¯

---

**Q7ï¼šJDK åŠ¨æ€ä»£ç†å’Œ CGLIB åŠ¨æ€ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

**A**ï¼š

| å¯¹æ¯”é¡¹ | JDK åŠ¨æ€ä»£ç† | CGLIB åŠ¨æ€ä»£ç† |
|--------|-------------|---------------|
| **åŸç†** | åŸºäºæ¥å£ï¼Œä½¿ç”¨åå°„ | åŸºäºç»§æ‰¿ï¼Œä½¿ç”¨å­—èŠ‚ç æŠ€æœ¯ |
| **ä»£ç†å¯¹è±¡** | æ¥å£çš„å®ç°ç±» | ç±»çš„å­ç±» |
| **æ€§èƒ½** | è¾ƒæ…¢ | è¾ƒå¿« |
| **é™åˆ¶** | åªèƒ½ä»£ç†æ¥å£ | ä¸èƒ½ä»£ç† final ç±»å’Œæ–¹æ³• |

---

**Q8ï¼šSpring AOP ä½¿ç”¨ä»€ä¹ˆä»£ç†ï¼Ÿ**

**A**ï¼š
- å¦‚æœç›®æ ‡å¯¹è±¡å®ç°äº†æ¥å£ï¼Œé»˜è®¤ä½¿ç”¨ **JDK åŠ¨æ€ä»£ç†**
- å¦‚æœç›®æ ‡å¯¹è±¡æ²¡æœ‰å®ç°æ¥å£ï¼Œä½¿ç”¨ **CGLIB åŠ¨æ€ä»£ç†**
- å¯ä»¥é€šè¿‡é…ç½®å¼ºåˆ¶ä½¿ç”¨ CGLIBï¼š`@EnableAspectJAutoProxy(proxyTargetClass = true)`

---

**Q9ï¼šMyBatis çš„ Mapper æ¥å£æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ**

**A**ï¼šMyBatis ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ä¸º Mapper æ¥å£åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œåœ¨ä»£ç†å¯¹è±¡ä¸­è°ƒç”¨ `SqlSession` æ‰§è¡Œ SQLã€‚

---

## 10.4 å¤–è§‚æ¨¡å¼ç›¸å…³

**Q10ï¼šä»€ä¹ˆæ˜¯å¤–è§‚æ¨¡å¼ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜ã€‚**

**A**ï¼šå¤–è§‚æ¨¡å¼ä¸ºå­ç³»ç»Ÿæä¾›ç»Ÿä¸€çš„æ¥å£ã€‚ä¾‹å¦‚ï¼ŒSpring MVC çš„ `DispatcherServlet` ä½œä¸ºå‰ç«¯æ§åˆ¶å™¨ï¼Œç»Ÿä¸€å¤„ç†è¯·æ±‚ã€‚

---

## 10.5 ç»¼åˆé—®é¢˜

**Q11ï¼šè®¾è®¡æ¨¡å¼ä¸­å“ªäº›æ¨¡å¼ä½¿ç”¨äº†ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ï¼Ÿ**

**A**ï¼š
- **é€‚é…å™¨æ¨¡å¼**ï¼ˆå¯¹è±¡é€‚é…å™¨ï¼‰
- **è£…é¥°å™¨æ¨¡å¼**
- **ä»£ç†æ¨¡å¼**
- **å¤–è§‚æ¨¡å¼**
- **æ¡¥æ¥æ¨¡å¼**

è¿™äº›æ¨¡å¼éƒ½ä½“ç°äº†"ç»„åˆä¼˜äºç»§æ‰¿"çš„è®¾è®¡åŸåˆ™ã€‚

---

**Q12ï¼šå¦‚ä½•é€‰æ‹©ä½¿ç”¨å“ªç§ç»“æ„å‹æ¨¡å¼ï¼Ÿ**

**A**ï¼š
- **éœ€è¦è½¬æ¢æ¥å£** â†’ é€‚é…å™¨æ¨¡å¼
- **éœ€è¦åŠ¨æ€å¢å¼ºåŠŸèƒ½** â†’ è£…é¥°å™¨æ¨¡å¼
- **éœ€è¦æ§åˆ¶è®¿é—®** â†’ ä»£ç†æ¨¡å¼
- **éœ€è¦ç®€åŒ–å¤æ‚å­ç³»ç»Ÿ** â†’ å¤–è§‚æ¨¡å¼
- **éœ€è¦åˆ†ç¦»æŠ½è±¡å’Œå®ç°** â†’ æ¡¥æ¥æ¨¡å¼

---

## 10.6 å®æˆ˜é—®é¢˜

**Q13ï¼šå¦‚ä½•æ‰‹å†™ä¸€ä¸ª JDK åŠ¨æ€ä»£ç†ï¼Ÿ**

**A**ï¼šå‚è€ƒ [4.2.2 JDK åŠ¨æ€ä»£ç†](#422-jdk-åŠ¨æ€ä»£ç†-é‡ç‚¹) çš„ä»£ç ç¤ºä¾‹ã€‚

---

**Q14ï¼šå¦‚ä½•æ‰‹å†™ä¸€ä¸ª CGLIB åŠ¨æ€ä»£ç†ï¼Ÿ**

**A**ï¼šå‚è€ƒ [4.2.3 CGLIB åŠ¨æ€ä»£ç†](#423-cglib-åŠ¨æ€ä»£ç†-é‡ç‚¹) çš„ä»£ç ç¤ºä¾‹ã€‚

---

## å­¦ä¹ æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬è¯¾ä»¶å­¦ä¹ åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

- [ ] è¯´å‡º 7 ç§ç»“æ„å‹æ¨¡å¼åŠå…¶æ ¸å¿ƒæ€æƒ³
- [ ] æ‰‹å†™é€‚é…å™¨æ¨¡å¼ï¼ˆç±»é€‚é…å™¨ã€å¯¹è±¡é€‚é…å™¨ï¼‰
- [ ] æ‰‹å†™è£…é¥°å™¨æ¨¡å¼ï¼Œå¹¶è¯´æ˜ä¸ç»§æ‰¿ã€ä»£ç†çš„åŒºåˆ«
- [ ] æ‰‹å†™é™æ€ä»£ç†ã€JDK åŠ¨æ€ä»£ç†ã€CGLIB åŠ¨æ€ä»£ç†
- [ ] è¯´æ˜ JDK åŠ¨æ€ä»£ç†å’Œ CGLIB åŠ¨æ€ä»£ç†çš„åŒºåˆ«
- [ ] æ‰‹å†™å¤–è§‚æ¨¡å¼ï¼Œå¹¶è¯´æ˜åº”ç”¨åœºæ™¯
- [ ] æ‰‹å†™æ¡¥æ¥æ¨¡å¼ï¼Œå¹¶è¯´æ˜ä¸é€‚é…å™¨çš„åŒºåˆ«
- [ ] è¯´å‡ºç»“æ„å‹æ¨¡å¼åœ¨ Spring/JDK ä¸­çš„åº”ç”¨
- [ ] å›ç­”é¢è¯•ä¸­çš„ç»“æ„å‹æ¨¡å¼ç›¸å…³é—®é¢˜

---

**æ­å–œï¼ä½ å·²ç»æŒæ¡äº†ç»“æ„å‹è®¾è®¡æ¨¡å¼çš„æ ¸å¿ƒå†…å®¹ï¼** ğŸ‰

æ¥ä¸‹æ¥ï¼Œè¯·å®Œæˆ `03-å®éªŒä¸ç»ƒä¹ .md` ä¸­çš„å®éªŒï¼Œå¹¶åœ¨ `02-å­¦ä¹ ç¬”è®°.md` ä¸­è®°å½•ä½ çš„å­¦ä¹ å¿ƒå¾—ã€‚
