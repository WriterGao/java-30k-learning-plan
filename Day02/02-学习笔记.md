# Day02 学习笔记

> **学习目标**：今天的笔记目标是"**能复述、能画图、能用日志验证**"，不要抄书。  
> **参考课件**：`00-教学课件_GC算法与垃圾收集器详解.md`

---

## 1. 对象存活判断（用你自己的话）

### 1.1 引用计数法

- **原理**：
- **缺陷**（循环引用问题）：
- **Python/其他语言如何使用引用计数**：

### 1.2 可达性分析

- **原理**：
- **GC Roots 包括哪些**（至少列出 4 种）：
  1. 
  2. 
  3. 
  4. 

### 1.3 对比图

请画一张引用计数法 vs 可达性分析的对比图：

```
（在此画图或用文字描述）
```

---

## 2. 四种引用类型

### 2.1 对比表

请填写下表：

| 引用类型 | 回收时机 | 用途 | 对应类 |
|---------|---------|------|-------|
| 强引用 | | | |
| 软引用 | | | |
| 弱引用 | | | |
| 虚引用 | | | |

### 2.2 代码验证

运行 `code/ReferenceDemo.java` 后，记录你观察到的现象：

- **软引用在内存充足时**：
- **软引用在内存不足时**：
- **弱引用在 GC 后**：
- **虚引用的特殊行为**：

---

## 3. 垃圾回收算法

### 3.1 标记-清除（Mark-Sweep）

- **过程**：
- **优点**：
- **缺点**：

### 3.2 复制算法（Copying）

- **过程**：
- **优点**：
- **缺点**：
- **在新生代中的应用**（Eden + 2 个 Survivor）：

### 3.3 标记-整理（Mark-Compact）

- **过程**：
- **优点**：
- **缺点**：

### 3.4 分代收集

- **为什么要分代**：
- **新生代用什么算法**：
- **老年代用什么算法**：

---

## 4. GC 类型

### 4.1 对比表

| GC 类型 | 回收范围 | 触发条件 | 特点 |
|---------|---------|---------|------|
| Minor GC | | | |
| Major GC | | | |
| Full GC | | | |

### 4.2 实际观察

运行 `code/GCLogDemo.java` 后，记录：

- **Minor GC 次数**：
- **Full GC 次数**：
- **GC 暂停时间**：

---

## 5. 垃圾收集器

### 5.1 收集器总览

请画出收集器的搭配关系图：

```
（在此画图）
新生代收集器        老年代收集器
───────────       ───────────
Serial    ←────→  Serial Old
ParNew    ←────→  CMS
Parallel  ←────→  Parallel Old
          G1（新生代 + 老年代）
```

### 5.2 每种收集器的特点

#### Serial / Serial Old
- **工作原理**：
- **适用场景**：
- **优缺点**：

#### ParNew
- **工作原理**：
- **适用场景**：
- **优缺点**：

#### Parallel Scavenge / Parallel Old
- **工作原理**：
- **适用场景**：
- **优缺点**：

#### CMS
- **四个阶段**：
  1. 初始标记：
  2. 并发标记：
  3. 重新标记：
  4. 并发清除：
- **优缺点**：
- **Concurrent Mode Failure 如何处理**：

#### G1
- **Region 机制**：
- **回收过程**：
- **优缺点**：
- **适用场景**：

### 5.3 新一代收集器

#### ZGC
- **核心特点**：
- **适用场景**：

#### Shenandoah
- **核心特点**：
- **适用场景**：

---

## 6. GC 日志分析

### 6.1 日志格式

记录你在实验中看到的 GC 日志，并逐字段解读：

```
（粘贴你的GC日志）
```

**各字段含义**：
- 
- 
- 

### 6.2 常用 GC 参数

列出你使用过的 GC 相关 JVM 参数：

```bash
# 在此记录
```

---

## 7. 安全点与安全区域

### 7.1 安全点（Safepoint）

- **定义**：
- **为什么需要安全点**：
- **如何让线程到达安全点**（主动式中断 vs 抢先式中断）：

### 7.2 安全区域（Safe Region）

- **定义**：
- **为什么需要安全区域**：
- **与安全点的关系**：

---

## 8. 收集器选型

### 8.1 选型决策

- **小型应用（< 100MB 堆）**：
- **吞吐量优先**：
- **低延迟优先**：
- **超大堆（> 16GB）**：

### 8.2 我的项目应该选什么收集器？

- **项目类型**：
- **选择的收集器**：
- **选择理由**：

---

## 9. 5 分钟复述稿（面试式）

用 5 分钟讲清楚"GC 算法与垃圾收集器"，要求：
- 先总览，再逐一解释，再给 1 个实际调优案例

**我的复述稿**：

```
【总览】
Java的垃圾回收机制包括...

【判断对象存活】
JVM通过可达性分析来判断对象是否存活...

【回收算法】
1. 标记-清除：...
2. 复制算法：...
3. 标记-整理：...
4. 分代收集：...

【常用收集器】
1. Serial/Serial Old：...
2. ParNew + CMS：...
3. Parallel Scavenge + Parallel Old：...
4. G1：...

【调优案例】
我曾经遇到一个GC停顿问题...
```

---

## 10. 学习总结与疑问

### 10.1 今天学到的核心知识点

1. 
2. 
3. 
4. 
5. 

### 10.2 还有疑问的地方

1. 
2. 

### 10.3 下一步学习计划

- [ ] 复习课件中的检查清单
- [ ] 回顾面试高频问题，确保能流畅回答
- [ ] 准备 Day03 的学习

---

> **提示**：完成笔记后，对照课件最后的检查清单进行自我验收。
